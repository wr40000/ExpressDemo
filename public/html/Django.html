<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://139.159.253.241:3000/stylesheets/github.css">
    <title>Document</title>
</head>
<body>
    <h1>创建项目及使用</h1>
<p><img src="typora-user-images.assets/image-20230417210353215.png" alt="image-20230417210353215"></p>
<p><img src="typora-user-images.assets/image-20230418104741328.png" alt="image-20230418104741328"></p>
<pre><code>django-admin help

2. 创建Django项目
新建个文件夹，cmd进入该目录，输入以下代码

django-admin startproject testdj

3. 创建APP
在项目根目录输入命令

python manage.py startapp login

4. 编写路由
路由是浏览器输入url，在Django服务器响应url的转发中心。路由都写在urls文件里，它将浏览器输入的url映射到相应的业务处理逻辑也就是视图。简单的urls编写方法如下图：

5. 编写视图函数
路由转发用户请求到视图函数。视图函数处理用户请求，也就是编写业务处理逻辑，一般都在views.py文件里。我们下面写一个简单的视图函数：

6. 运行web服务
现在我们已经可以将web服务运行起来了。

命令行的方式是：

python manage.py runserver 127.0.0.1:8000

7. 返回HTML文件
上面我们返回给用户浏览器的是什么？一个字符串！实际上这肯定不行，通常我们都是将HTML文件返回给用户。
</code></pre>
<h2>Django框架基础篇--响应HttpResponse相关知识点</h2>
<pre><code>http://t.csdn.cn/sCAlY
</code></pre>
<h2><a href="https://so.csdn.net/so/search?q=HttpResponse&spm=1001.2101.3001.7020">HttpResponse</a>对象</h2>
<h3>概述：</h3>
<blockquote>
<p>作用：给浏览器返回数据，<a href="https://so.csdn.net/so/search?q=HttpRequest&spm=1001.2101.3001.7020">HttpRequest</a>对象是由Django创建的，HttpResponse对象是由程序员创建</p>
</blockquote>
<h3>用法：</h3>
<blockquote>
<pre><code> 不用模板，直接返回数据
                语句示例：return HttpResponse(&quot;Sunck is a good man&quot;)
            调用模板
                使用render方法
                    原型：render(request, templateName[, context])
                    作用:结合数据和模板，返回一个完整的HTML页面
                    参数：
                        request：请求体对象
                        templateName：模板路径
                        context：传递给需要渲染在模板上的数据
        属性
            content:表示返回内容
            charset:编码格式
            status_code:响应状态码
                200
                304
                404
                400
            content-type:指定输出的MIME类型
        方法
            init:使用页面内容实例化HttpResponse对象
            write(content):以文件的形式写入
            flush():以文件的形式输出缓冲区
            set_cookie(key, value, maxAge=None, exprise=None)
            delete_cookie(key):
                删除cookie
                如果删除一个不存在的cookie，就当什么都没发生
</code></pre>
</blockquote>
<h3>子类HttpResponseRedirect</h3>
<blockquote>
<pre><code>功能：重定向，服务器端的跳转
            简写
                redirect(to)
            to推荐使用反向解析
            示例：
                from django.http import HttpResponseRedirect
                from django.shortcuts import redirect
                def redirect1(request):
                    # return HttpResponseRedirect(&#39;/redirect2&#39;)
                    return redirect(&#39;/redirect2&#39;)
                def redirect2(request):
                    return HttpResponse(&quot;我是重定向后的视图&quot;)
</code></pre>
</blockquote>
<h3>子类JsonResponse</h3>
<blockquote>
<pre><code>返回Json数据，一般用于异步请求
            __init__(self.data)
            data 字典
            注意：Content-type类型为application/json
</code></pre>
</blockquote>
<h3>状态保持</h3>
<blockquote>
<pre><code>http协议是无状态的，每次请求都是一次新的请求，它不记得之前的请求。
        客户端与服务器的一次通信就是一次会话
        实现状态的保持，在客户端或服务端存储有关会话的数据
        存储的方式
            cookie:所有数据存储在客户端，不要存储敏感的数据
            session:所有的数据存储在服务端，在客户端用cookie存储session_id
        状态保持的目的:
            在一段时间内跟踪请求者的状态，可以实现跨页面访问当前的请求者的数据
        注意：不同的请求者之间不会共享这个数据，与请求者一一对应
        启用session:project\project\settings.py
            INSTALLED_APPS    &#39;django.contrib.sessions&#39;,
            MIDDLEWARE    &#39;django.contrib.sessions.middleware.SessionMiddleware&#39;,
</code></pre>
</blockquote>
<h3>使用session</h3>
<blockquote>
<pre><code>启用session后，每个httpRequest对象都有一个session属性
            get[key, default=None]    根据键获取session值
            clear()    清空所有会话
            flush()    删除当前会话并删除会话的cookie
            示例：
                # session
                def main(request):
                    # 取session
                    username = request.session.get(&#39;name&#39;, &#39;游客&#39;)
                    print(username)
                    return render(request, &#39;myApp/main.html&#39;, {&#39;username&#39;: username})

                def login(request):
                    return render(request, &#39;myApp/login.html&#39;)

                def showmain(request):
                    print(&quot;*****************&quot;)
                    username = request.POST.get(&#39;username&#39;)
                    # 存储session
                    request.session[&#39;name&#39;] = username
                    return redirect(&#39;/main/&#39;)

                from django.contrib.auth import logout
                def quit(request):
                    # 清除session
                    logout(request) # 方法1，推荐
                    # request.session.clear() # 方法2
                    request.session.flush() # 方法3
                    return redirect(&#39;/main/&#39;)
</code></pre>
</blockquote>
<h3>设置session过期时间</h3>
<blockquote>
<pre><code>set_expiry(value)
            request.session.set_expiry(10)  设置为10秒后过期
            如果不设置，2个星期后过期
            value设置为0代表关闭浏览器时过期
            value设置为None代表设置永不过期，不推荐
</code></pre>
</blockquote>

</body>
</html>